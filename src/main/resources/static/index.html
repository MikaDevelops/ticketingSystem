<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>

        var incidentsData;
        
        async function loadAllIncidents(){
            try{
                const response = await fetch("http://localhost:8080/api/v1/incidents");
                if (!response.ok) throw new Error(`response status: ${response.status}`);

                incidentsData = await response.json();
                listAllIncidents();
            }
            catch(error){
                alert(error.message);
            }
        }
        function listAllIncidents(){
            let incidentElement = document.getElementById("case-list");
            incidentElement.replaceChildren();

            for (row of incidentsData){
                let incidentId = document.createElement("DIV");
                incidentId.innerText=row.incidentId;
                let subject = document.createElement("DIV");
                subject.innerText=row.subject;
                let status = document.createElement("DIV");
                status.innerText=row.statusName;
                let customer = document.createElement("DIV");
                customer.innerText = [row.customerFirstName,row.customerMiddleName,row.customerLastName].join(" ");
                let supportPerson = document.createElement("DIV");
                supportPerson.innerText = row.incidentServicePersons.join(", ");
                 //   `<div id="${incidentId}"></div><div>${subject}</div><div>${status}</div><div>${customer}</div><div>${supportPerson}</div>`;
                document.getElementById("case-list").append(incidentId,subject,status,customer,supportPerson);
            }
        }

        loadAllIncidents();
        
    </script>
    <style>
        .case-list-container{
            display:grid;
            grid-template-columns: auto auto auto auto auto;
        }
    </style>
</head>
<body>
  <h1>This is the ticketing service web page</h1>
  <div id="casedata"></div>
  <div id="case-list" class="case-list-container"></div>
</body>
</html>